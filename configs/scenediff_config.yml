# SceneDiff Configuration
# ======================

# Model Paths and Checkpoints
models:
  pi3:
    name: "yyfz233/Pi3"
    device: "cuda"
  
  sam:
    checkpoint: "checkpoints/sam_vit_h_4b8939.pth"
    points_per_side: 32
    pred_iou_thresh: 0.7
    box_nms_thresh: 0.7
    stability_score_thresh: 0.85
    crop_n_layers: 0
    crop_n_points_downscale_factor: 1
    min_mask_region_area: 100
  
  dinov3:
    model_name: "dinov3_vith16plus"
    feature_dim: 1280

# Dataset Configuration
dataset:
  gt_dir: "data/scenediff_benchmark"
  splits:
    val: "splits/val_split.json"
    test: "splits/test_split.json"
  resample_rate: 30

# Processing Configuration
processing:
  visible_percentage: 0.5 # Visible percentage for view pairing
  subsample_size: 1000000 # Subsample size for point cloud generation
  total_voxel_number: 200 # Total number of voxels in geometry normalization
  occlusion_threshold: -0.02 # Occlusion threshold

# Cost Computation Weights
costs:
  lambda_geo: 1.0 # Weight for geometric score
  lambda_dino: 0.5 # Weight for appearance score
  lambda_dino_region_match: 0.2 # Weight for region matching score

# Object Detection Thresholds
detection:
  min_detection_pixel: 100 # Minimum number of pixels for detection
  threshold_method: "max_entropy"  # Options: "otsu", "max_entropy"
  change_region_threshold: null  # null for auto, or specify a float
  filter_percentage_before_threshold: 0.5 # Percentage of pixels to filter before thresholding
  max_score: 0.5 # Maximum score for detection
  max_detected_objects: 1000 # Maximum number of objects to detect

# Object Merging Parameters
merging:
  geometry_distance_threshold_of_voxel_size: 2 # Distance threshold for geometric matching of voxels
  visual_threshold_ratio: 0.7 # Visual similarity threshold for merging obejcts within each video
  geometry_threshold_ratio: 0.5 # Geometric similarity threshold for merging obejcts within each video
  general_threshold: 1.4 # Combined similarity threshold for merging obejcts within each video
  object_similarity_threshold: 0.7 # Similarity threshold for pairing moved objects across videos

# Aggregation Options
aggregation:
  mean_over_visible_region_during_cost_aggregation: true
  merge_pc_before_and_after: true

# Caching and Visualization
cache:
  use_cache: false # Load the cost maps and visible maps from the output directory
  save_cache: false # Save the cost maps and visible maps to the output directory

visualization:
  vis_pc: false # Save the point cloud visualizations to the output directory
  save_detections: true
  save_gt_visualization: true

# Output Configuration
output:
  output_dir: "output"
  save_object_masks: true
